\chapter{XML skema for resource}
\label{chap:XML_skema_for_resource}
\section{Formål}
\label{sec:formaal_skemaet}
Det primære formål med et XML skema, er muligheden for at validere et XML dokument, og på den måde kontrollere at det aftalte format er overholdt. Ofte kan disse skemaer, som i sig selv er XML dokumenter, også bruges til at automatisk generering af kode til behandling af alle de XML dokumenter som er valide i forhold til skemaet. Dette sker typisk gennem tredjeparts software. 
Et XML skema skal beskrive to vigtige egenskaber for at opfylde det beskrevne behov. 
\begin{description}
	\item[Struktur] som beskriver forholdet mellem forældre og børn elementer. Her kommer complexType og sequence i spil
	\item[Datatype] som angiver format eller værdisæt for det data der er gemt i elementerne. Her benyttes simpleType og restriction.
\end{description}
Med analyse funktionen fra kapitel \ref{chap:analyse_xml_struktur}, er det nemt at komme igang med at definere et skema, som kan validere strukturen i xml dokumentet. Med resultatet fra den automatiske analyse er grundstrukturen i skemaet klarlagt.
Men resultatet fra \funk{analyze} indeholder ikke nogen information om datatyperne. Det kan være svært at fastslå disse automatisk, da det typisk forudsætter en del domæne viden. Datatyperne vil derfor i høj grad blive udledt udfra deres navne og manuel genkendelse af f.eks. et dato format. Nogle af begrænsningerne(restrictions) der benyttes i skemaet, er tilføjet udelukkende for at demonstrere flere forskellige typer af begrænsninger, og vil måske ikke være korrekte i XML dokumentets virkelige domæne, på trods af at denne instans af dokumentet overholder dem.

\section{Skemaet \fil{resource.xsd}}
\label{sec:skemaet}

Det endelige skema kan ses i filen \fil{Data/resource.xsd}. Skemaet er opbygget, ved en manuel gennemgang af analyse resultatet i bilag \ref{app:Genereret analyse af resource.xml}. Hvert element er behandlet, og en type med en passende defintion er oprettet i skemaet. Der er brugt navngivne typer i stor udstrækning, da det øger læsbarheden væsentligt. 
Elementerne i skemaet beskrives her, grupperet udfra hvordan de er defineret. 
\vspace{1.5mm}
\begin{compactitem}
  \item 
Følgende elementer i dokumentet er defineret som komplekse, med en sekvens af underelementer:
  \begin{compactitem}
    \item \xmlelm{root} anonym type
		\item \xmlelm{resource} resourceType
		\item \xmlelm{itemdate} itemdateType
		\item \xmlelm{identifier} identifierType
		\item \xmlelm{publisher} publisherType
		\item \xmlelm{image} imageType
		\item \xmlelm{interestingfact} interestingfactType
		\item \xmlelm{subjects} subjectsType
		\item \xmlelm{subject} subejctType
		\item \xmlelm{resourcekeywords} resourcekeywordsType
		\item \xmlelm{keywords} anonym type
  \end{compactitem}
	\vspace{1.0mm}
Gældende for en sekvens er at alle elementerne skal optræde i den angivede rækkefølge. Dette er i modsætning til en anden indikator all, hvor om det gælder at elementerne kan optræde i en vilkårlig rækkefølge. 
For hvert element i sekvensen kan der angives kardinalitet, ved brug af indikatorerne minOccurs og maxOccurs, og her er brugt de værdier som analyse funktionen returnerede.
	
	\vspace{1.0mm}
	\item Følgende elementer er defineret som simple typer, med en begrænsing angivet i forhold til den valgte basis type:
	\begin{compactitem}
	  \item \xmlelm{title} titleType oprettes med basistypen string, og minLength og maxLength angives til hhv. 5 og 110. 
		\item \xmlelm{url} urlType oprettes med basistypen string, og med et meget simpelt pattern der matcher formattet for en url.
		\item \xmlelm{sourceurl} refererer til den navngivne type urlType, der er forklaret ovenfor.
	  \item \xmlelm{primary} primaryType oprettes med basistypen string, og en enumeration der angiver de valide værdier for elementet.
	\end{compactitem}
	\vspace{1.0mm}	
  Disse typer illustrerer meget godt brugen af begrænsninger, hvor det i forvejen udbyggede typehieraki nemt kan udvides med mere specialiserede typer.
	
	\vspace{1.0mm}
  \item Følgende elementer defineres ved brug af standard typer:
	\begin{compactitem}
 		\item \xmlelm{ID} positivInteger
    \item \xmlelm{description} string
		\item \xmlelm{category} string
		\item \xmlelm{subcategory} string
		\item \xmlelm{term} string
  	\item \xmlelm{text} string
		\item \xmlelm{caption} string
		\item \xmlelm{alttext} string
		\item \xmlelm{name} string
		\item \xmlelm{agency} string
		\item \xmlelm{recordcreated} date
		\item \xmlelm{placedonline} date
  \end{compactitem}
\end{compactitem}
\vspace{1.5mm}

\section{Konklusion}
\label{sec:Konklusion_xmlskema}
Med et skema defineret, kan xml strukturen valideres. Der er oprettet en kopi af resource.xml, kaldet resource\_with\_namespace.xml, og koden fra figur \ref{code:reference_til_skema} er tilføjet i den nyoprettede fil. Dette er gjort, for ikke at redigere i kilde-filen. Nu er der tilføjet en reference til skemaet i rod elementet, og valideringen kan foretages med et passende værktøj. I projektet er \prg{Notepad++} samt pluginet 'xml tools' brugt til at foretage valideringen. 

\begin{figure}[ht]
\centering
\begin{BVerbatim} 
<root xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
      xsi:noNamespaceSchemaLocation="resource.xsd">
\end{BVerbatim}
\caption{Reference til skema tilføjet i dokumentroden}
\label{code:reference_til_skema}
\end{figure}

\noindent Ikke overaskende er strukturen valid i forhold til det nye skema.

